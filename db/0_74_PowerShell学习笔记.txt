<html><head></head><body><h2 id="文件批量改后缀"><a href="https://mxts.jiujiuer.xyz/2022/06/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Script/PowerShell%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#%E6%96%87%E4%BB%B6%E6%89%B9%E9%87%8F%E6%94%B9%E5%90%8E%E7%BC%80" class="headerlink" title="文件批量改后缀"></a>文件批量改后缀</h2><figure class="highlight ps"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/></pre></td><td class="code"><pre><span class="line"><span class="built_in">dir</span> * | <span class="keyword">foreach</span> { <span class="built_in">Rename-Item</span> <span class="variable">$_</span> <span class="literal">-NewName</span> (<span class="variable">$_</span>.BaseName+”.mp4”)  }</span><br/></pre></td></tr></tbody></table></figure><h2 id="解除端口占用"><a href="https://mxts.jiujiuer.xyz/2022/06/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Script/PowerShell%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#%E8%A7%A3%E9%99%A4%E7%AB%AF%E5%8F%A3%E5%8D%A0%E7%94%A8" class="headerlink" title="解除端口占用"></a>解除端口占用</h2><p>首先找到占用端口的进程，然后终止进程：</p><figure class="highlight ps"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line">netstat <span class="literal">-nao</span> | findstr <span class="string">&#34;5554&#34;</span> <span class="comment"># 假设5554端口被占用</span></span><br/><span class="line">taskkill <span class="literal">-pid</span> <span class="number">5076</span> <span class="operator">-f</span>  <span class="comment"># 结束占用进程</span></span><br/></pre></td></tr></tbody></table></figure><h2 id="查找文件"><a href="https://mxts.jiujiuer.xyz/2022/06/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Script/PowerShell%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#%E6%9F%A5%E6%89%BE%E6%96%87%E4%BB%B6" class="headerlink" title="查找文件"></a>查找文件</h2><p>如果不指定<code>Path</code>则默认查找当前目录。查找支持正则表达式。</p><figure class="highlight ps"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ChildItem</span> <span class="literal">-Path</span> C:\Users\JohnDoe <span class="literal">-Filter</span> *.txt <span class="literal">-Recurse</span></span><br/></pre></td></tr></tbody></table></figure><h2 id="批量git-push"><a href="https://mxts.jiujiuer.xyz/2022/06/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Script/PowerShell%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#%E6%89%B9%E9%87%8Fgit-push" class="headerlink" title="批量git push"></a>批量git push</h2><figure class="highlight ps"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ChildItem</span> <span class="literal">-Directory</span> | <span class="built_in">ForEach-Object</span> {</span><br/><span class="line">    <span class="variable">$gitDir</span> = <span class="built_in">Join-Path</span> <span class="variable">$_</span>.FullName <span class="string">&#34;.git&#34;</span></span><br/><span class="line">    <span class="keyword">if</span> (<span class="built_in">Test-Path</span> <span class="variable">$gitDir</span>) {</span><br/><span class="line">        <span class="built_in">Set-Location</span> <span class="variable">$_</span>.FullName</span><br/><span class="line">        git push</span><br/><span class="line">    }</span><br/><span class="line">}</span><br/></pre></td></tr></tbody></table></figure></body></html>