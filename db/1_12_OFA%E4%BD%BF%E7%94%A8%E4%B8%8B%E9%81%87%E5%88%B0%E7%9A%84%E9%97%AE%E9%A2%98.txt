<html><head></head><body><blockquote><p><a href="https://github.com/OFA-Sys/OFA">OFA</a><br/><a href="https://colab.research.google.com/github/mit-han-lab/once-for-all/blob/master/tutorial/ofa.ipynb#scrollTo=AUhMWvPdr0Z6">OFA样例</a></p></blockquote><p>又是瞎折腾的一天…  </p><h2 id="一、Linux下搭建"><a href="https://xiue233.github.io/2022/12/04/ofa_bugs/#%E4%B8%80%E3%80%81Linux%E4%B8%8B%E6%90%AD%E5%BB%BA" class="headerlink" title="一、Linux下搭建"></a>一、Linux下搭建</h2><p>按照要求搭建即可，没啥特殊的情况，注意把需要的库下载完整。  </p><p>但是我的Linux因为种种原因挂不上N卡，我就换Windows了。</p><h2 id="二、Windows下搭建"><a href="https://xiue233.github.io/2022/12/04/ofa_bugs/#%E4%BA%8C%E3%80%81Windows%E4%B8%8B%E6%90%AD%E5%BB%BA" class="headerlink" title="二、Windows下搭建"></a>二、Windows下搭建</h2><h3 id="1-torch-cuda-is-available-为False"><a href="https://xiue233.github.io/2022/12/04/ofa_bugs/#1-torch-cuda-is-available-%E4%B8%BAFalse" class="headerlink" title="(1) torch.cuda.is_available()为False"></a>(1) torch.cuda.is_available()为False</h3><p>需要安装Nvidia Toolkit,并且安装特定版本的torch即可。</p><h3 id="2-运行时报错，报错中显示让使用freeze-support"><a href="https://xiue233.github.io/2022/12/04/ofa_bugs/#2-%E8%BF%90%E8%A1%8C%E6%97%B6%E6%8A%A5%E9%94%99%EF%BC%8C%E6%8A%A5%E9%94%99%E4%B8%AD%E6%98%BE%E7%A4%BA%E8%AE%A9%E4%BD%BF%E7%94%A8freeze-support" class="headerlink" title="(2) 运行时报错，报错中显示让使用freeze_support()"></a>(2) 运行时报错，报错中显示让使用freeze_support()</h3><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line">RuntimeError: </span><br/><span class="line">        An attempt has been made to start a new process before the</span><br/><span class="line">        current process has finished its bootstrapping phase.</span><br/><span class="line">        This probably means that you are not using fork to start your</span><br/><span class="line">        child processes and you have forgotten to use the proper idiom</span><br/><span class="line">        in the main module:</span><br/><span class="line">            if __name__ == &#39;__main__&#39;:</span><br/><span class="line">                freeze_support()</span><br/><span class="line">                ...</span><br/><span class="line">        The &#34;freeze_support()&#34; line can be omitted if the program</span><br/><span class="line">        is not going to be frozen to produce an executable.</span><br/></pre></td></tr></tbody></table></figure><p>这个是因为Windows和Linux下mutilprocessing实现不同的问题，可以参考下面几个帖子:</p><p><a href="https://github.com/pyinstaller/pyinstaller/wiki/Recipe-Multiprocessing">Recipe-Multiprocessing</a>   </p><p><a href="https://blog.csdn.net/weixin_42316691/article/details/120993311?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167012141816800186577851%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=167012141816800186577851&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-22-120993311-null-null.142%5Ev67%5Econtrol,201%5Ev3%5Econtrol_1,213%5Ev2%5Et3_esquery_v3&amp;utm_term=windows%20freeze_support&amp;spm=1018.2226.3001.4187">The “freeze_support()“ line can be omitted if the program</a>   </p><p><a href="https://blog.csdn.net/weixin_47269200/article/details/115443949?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167012141816800186577851%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=167012141816800186577851&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-21-115443949-null-null.142%5Ev67%5Econtrol,201%5Ev3%5Econtrol_1,213%5Ev2%5Et3_esquery_v3&amp;utm_term=windows%20freeze_support&amp;spm=1018.2226.3001.4187">python运行子进程时报错：The “freeze_support()“ line can be omitted if the program is not going to be froze</a>   </p><p><a href="https://chtalhaanwar.medium.com/pytorch-num-workers-a-tip-for-speedy-training-ed127d825db7">PyTorch num_workers, a tip for speedy training</a>   </p><p>最后，我的解决方案就是，<strong>根据报错修改OFA库源码内涉及设置num_works的，改为0</strong>，就没有报错了(但是存在负面影响，具体可以看上面的链接)。</p></body></html>