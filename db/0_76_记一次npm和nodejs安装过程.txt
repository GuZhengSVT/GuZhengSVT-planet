<html><head></head><body><h2 id="背景"><a href="https://mxts.jiujiuer.xyz/2022/03/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JavaScript/%E8%AE%B0%E4%B8%80%E6%AC%A1npm%E5%92%8Cnodejs%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B/#%E8%83%8C%E6%99%AF" class="headerlink" title="背景"></a>背景</h2><p>最近接触vue-cli，需要用到nodejs和npm。直接<code>apt-get</code>安装完成后发现版本过低，换源也不解决问题。最后必应解决了。</p><h2 id="步骤"><a href="https://mxts.jiujiuer.xyz/2022/03/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JavaScript/%E8%AE%B0%E4%B8%80%E6%AC%A1npm%E5%92%8Cnodejs%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B/#%E6%AD%A5%E9%AA%A4" class="headerlink" title="步骤"></a>步骤</h2><p>首先彻底卸载nodejs和npm：</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/></pre></td><td class="code"><pre><span class="line">sudo apt-get --purge npm</span><br/><span class="line">sudo apt-get --purge nodejs</span><br/><span class="line">sudo apt-get --purge nodejs-legacy</span><br/></pre></td></tr></tbody></table></figure><p>然后去NodeSource获取换源指令并安装nodejs和npm，如下：</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/></pre></td><td class="code"><pre><span class="line"><span class="comment"># Using Ubuntu</span></span><br/><span class="line">curl -fsSL https://deb.nodesource.com/setup_14.x | sudo -E bash -</span><br/><span class="line">sudo apt-get install -y nodejs</span><br/><span class="line"></span><br/><span class="line"><span class="comment"># Using Debian, as root</span></span><br/><span class="line">curl -fsSL https://deb.nodesource.com/setup_14.x | bash -</span><br/><span class="line">apt-get install -y nodejs</span><br/></pre></td></tr></tbody></table></figure><p>完成。</p><h2 id="新的问题：npm-not-found"><a href="https://mxts.jiujiuer.xyz/2022/03/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JavaScript/%E8%AE%B0%E4%B8%80%E6%AC%A1npm%E5%92%8Cnodejs%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B/#%E6%96%B0%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%9Anpm-not-found" class="headerlink" title="新的问题：npm not found"></a>新的问题：npm not found</h2><p>我安装完成后发现，npm指令执行报错：</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/></pre></td><td class="code"><pre><span class="line">-bash: /usr/local/bin/npm: No such file or directory</span><br/></pre></td></tr></tbody></table></figure><p>经过排查，发现是符号链接异常导致：npm会安装在<code>/usr/bin/</code>下，而在<code>/usr/local/bin/</code>下会创建软链接指向前者。所以只需要删掉原来的链接再手动创建就可以啦：</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/local/bin/</span><br/><span class="line">sudo <span class="built_in">rm</span> npm &amp;&amp; sudo <span class="built_in">ln</span> -s /usr/bin/npm /usr/local/bin/npm</span><br/></pre></td></tr></tbody></table></figure><p>这时候再输入<code>npm -v</code>，就可以看到npm正常运行了。</p><h2 id="再安装"><a href="https://mxts.jiujiuer.xyz/2022/03/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JavaScript/%E8%AE%B0%E4%B8%80%E6%AC%A1npm%E5%92%8Cnodejs%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B/#%E5%86%8D%E5%AE%89%E8%A3%85" class="headerlink" title="再安装"></a>再安装</h2><p>直接扔<code>/usr/local</code>底下然后把<code>bin</code>加到<code>$PATH</code>就行，省时省力。</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/></pre></td><td class="code"><pre><span class="line">wget https://mirrors.ustc.edu.cn/node/latest-v20.x/node-v20.5.1-linux-x64.tar.gz \</span><br/><span class="line">&amp;&amp; tar -zxvf node-v20.5.1-linux-x64.tar.gz \</span><br/><span class="line">&amp;&amp; sudo <span class="built_in">mv</span> node-v20.5.1-linux-x64 /usr/local/node \</span><br/><span class="line">&amp;&amp; <span class="built_in">echo</span> <span class="string">&#39;export PATH=$PATH:&#34;/usr/local/node/bin&#34;&#39;</span> &gt;&gt; ~./bahsrc \</span><br/><span class="line">&amp;&amp; <span class="built_in">source</span> ~/.bashrc</span><br/></pre></td></tr></tbody></table></figure><h2 id="换源"><a href="https://mxts.jiujiuer.xyz/2022/03/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JavaScript/%E8%AE%B0%E4%B8%80%E6%AC%A1npm%E5%92%8Cnodejs%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B/#%E6%8D%A2%E6%BA%90" class="headerlink" title="换源"></a>换源</h2><p>一条指令就行，执行结果会在<code>~/.npmrc</code>里。</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br/></pre></td></tr></tbody></table></figure><p>换了淘宝源。</p></body></html>