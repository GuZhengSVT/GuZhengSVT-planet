<html><head></head><body><h1 id="用-RenderDoc-持续截帧-Unity-Editor-Game-View">用 RenderDoc 持续截帧 Unity Editor Game View<a class="headerlink" href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#%E7%94%A8-RenderDoc-%E6%8C%81%E7%BB%AD%E6%88%AA%E5%B8%A7-Unity-Editor-Game-View" title="Permanent link">¶</a></h1><!-- more --><p>某些渲染 bug 只会持续很短的时间，手动抓帧根本抓不到。Unity 在 <code>UnityEditorInternal</code> 命名空间下，提供了 <a href="https://github.com/Unity-Technologies/UnityCsReference/blob/d2eb9c0352229c0268d47ca0efa69e14b5d180f8/Editor/Mono/RenderDoc/RenderDoc.bindings.cs#L32"><code>RenderDoc.BeginCaptureRenderDoc</code></a> 和 <a href="https://github.com/Unity-Technologies/UnityCsReference/blob/d2eb9c0352229c0268d47ca0efa69e14b5d180f8/Editor/Mono/RenderDoc/RenderDoc.bindings.cs#L34C28-L34C47"><code>RenderDoc.EndCaptureRenderDoc</code></a> 方法。可以用它们对 Game View 持续截帧。</p><h2 id="代码">代码<a class="headerlink" href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#%E4%BB%A3%E7%A0%81" title="Permanent link">¶</a></h2><p>随便给的快捷键：</p><ul><li>Alt+Shift+B 开始截帧</li><li>Alt+Shift+E 结束截帧</li></ul><p>为了防止和其他快捷键冲突，所以给得比较反人类。不过用的频率比较低，所以可以接受。</p><p>同时开多个 Game View 可能有问题，一个都不开必有问题。</p><div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-1"> 1</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-2"> 2</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-3"> 3</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-4"> 4</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-5"> 5</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-6"> 6</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-7"> 7</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-8"> 8</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-9"> 9</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-10">10</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-11">11</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-12">12</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-13">13</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-14">14</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-15">15</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-16">16</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-17">17</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-18">18</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-19">19</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-20">20</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-21">21</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-22">22</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-23">23</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-24">24</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-25">25</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-26">26</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-27">27</a></span><span class="normal"><a href="https://note.stalomeow.com/blog/posts/unity-editor-renderdoc-tool/#__codelineno-0-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">using</span><span class="w"> </span><span class="nn">System</span><span class="p">;</span></span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">using</span><span class="w"> </span><span class="nn">UnityEditor</span><span class="p">;</span></span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="k">using</span><span class="w"> </span><span class="nn">UnityEditor.ShortcutManagement</span><span class="p">;</span></span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="k">using</span><span class="w"> </span><span class="nn">UnityEditorInternal</span><span class="p">;</span></span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="k">using</span><span class="w"> </span><span class="nn">UnityEngine</span><span class="p">;</span></span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a></span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">RenderDocUtils</span></span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="p">{</span></span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w"> </span><span class="na">[Shortcut(&#34;RenderDocUtils/BeginCaptureGameView&#34;, KeyCode.B, ShortcutModifiers.Alt | ShortcutModifiers.Shift)]</span></span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">BeginCaptureGameView</span><span class="p">()</span></span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w"> </span><span class="p">{</span></span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w"> </span><span class="n">RenderDoc</span><span class="p">.</span><span class="n">BeginCaptureRenderDoc</span><span class="p">(</span><span class="n">GetActiveGameView</span><span class="p">());</span></span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w"> </span><span class="n">Debug</span><span class="p">.</span><span class="n">Log</span><span class="p">(</span><span class="s">&#34;RenderDoc capture started&#34;</span><span class="p">);</span></span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w"> </span><span class="p">}</span></span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15"></a></span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w"> </span><span class="na">[Shortcut(&#34;RenderDocUtils/EndCaptureGameView&#34;, KeyCode.E, ShortcutModifiers.Alt | ShortcutModifiers.Shift)]</span></span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">EndCaptureGameView</span><span class="p">()</span></span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w"> </span><span class="p">{</span></span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w"> </span><span class="n">RenderDoc</span><span class="p">.</span><span class="n">EndCaptureRenderDoc</span><span class="p">(</span><span class="n">GetActiveGameView</span><span class="p">());</span></span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w"> </span><span class="n">Debug</span><span class="p">.</span><span class="n">Log</span><span class="p">(</span><span class="s">&#34;RenderDoc capture ended&#34;</span><span class="p">);</span></span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w"> </span><span class="p">}</span></span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22"></a></span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w"> </span><span class="k">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">EditorWindow</span><span class="w"> </span><span class="nf">GetActiveGameView</span><span class="p">()</span></span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w"> </span><span class="p">{</span></span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">typeof</span><span class="p">(</span><span class="n">SceneView</span><span class="p">).</span><span class="n">Assembly</span><span class="p">.</span><span class="n">GetType</span><span class="p">(</span><span class="s">&#34;UnityEditor.GameView&#34;</span><span class="p">);</span></span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">EditorWindow</span><span class="p">.</span><span class="n">GetWindow</span><span class="p">(</span><span class="n">type</span><span class="p">);</span></span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="w"> </span><span class="p">}</span></span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="p">}</span></span></code></pre></div></td></tr></tbody></table></div></body></html>