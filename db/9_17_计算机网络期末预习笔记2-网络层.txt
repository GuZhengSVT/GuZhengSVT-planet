<html><head></head><body><h1 id="Chapter-19-逻辑寻址"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#Chapter-19-%E9%80%BB%E8%BE%91%E5%AF%BB%E5%9D%80" class="headerlink" title="Chapter 19 逻辑寻址"></a>Chapter 19 逻辑寻址</h1><p><img src="https://honoka.tech/img/Chapter19-22.assets/image-20210620224317997.png.webp" class="lazyload" data-srcset="/img/Chapter19-22.assets/image-20210620224317997.png.webp" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20210620224317997"/></p><p>哈哈, 全加粗了.</p><h2 id="IPv4地址"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#IPv4%E5%9C%B0%E5%9D%80" class="headerlink" title="IPv4地址"></a>IPv4地址</h2><p>常识性的东西就不说了.</p><h3 id="地址分类"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E5%9C%B0%E5%9D%80%E5%88%86%E7%B1%BB" class="headerlink" title="地址分类"></a>地址分类</h3><p>ABCDE五类地址</p><p><img src="https://honoka.tech/img/Chapter19-22.assets/image-20210620224445372.png.webp" class="lazyload" data-srcset="/img/Chapter19-22.assets/image-20210620224445372.png.webp" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20210620224445372"/></p><p>重点在ABC类上.</p><h4 id="A类地址"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#A%E7%B1%BB%E5%9C%B0%E5%9D%80" class="headerlink" title="A类地址"></a>A类地址</h4><p>A类地址网络号只有前8位, 其中第一位必须是0.</p><p>网络号全0表示本网络, 是预留的.</p><p>网络号后七位全1用于本地环回测试, 也是预留的.</p><p><strong>所以A类地址有 <svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="6.016ex" height="2.088ex" role="img" focusable="false" viewBox="0 -841 2659 923" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-1-TEX-N-37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z"></path><path id="MJX-1-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-1-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="37" xlink:href="#MJX-1-TEX-N-37"></use></g></g></g><g data-mml-node="mo" transform="translate(1158.8,0)"><use data-c="2212" xlink:href="#MJX-1-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(2159,0)"><use data-c="32" xlink:href="#MJX-1-TEX-N-32"></use></g></g></g></svg> 个网络</strong></p><p>主机号是后面24位.</p><p>主机号全0表示网络号指定的该网络, 预留.</p><p>主机号全1表示广播, 预留.</p><p><strong>所以A类地址一个网络最多有 <svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="6.816ex" height="2.09ex" role="img" focusable="false" viewBox="0 -841.7 3012.6 923.7" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-2-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-2-TEX-N-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path id="MJX-2-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"></use><use data-c="34" xlink:href="#MJX-2-TEX-N-34" transform="translate(500,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(1512.3,0)"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(2512.6,0)"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"></use></g></g></g></svg> 个主机</strong></p><h4 id="B类地址"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#B%E7%B1%BB%E5%9C%B0%E5%9D%80" class="headerlink" title="B类地址"></a>B类地址</h4><p>网络号有前面16位, 其中前两位必须是10.</p><p>网络号128.0是不指派, 最少也得是128.1</p><p><strong>所以B类地址有 <svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="6.816ex" height="2.09ex" role="img" focusable="false" viewBox="0 -841.7 3012.6 923.7" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-3-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-3-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-3-TEX-N-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path id="MJX-3-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-3-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-3-TEX-N-31"></use><use data-c="34" xlink:href="#MJX-3-TEX-N-34" transform="translate(500,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(1512.3,0)"><use data-c="2212" xlink:href="#MJX-3-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(2512.6,0)"><use data-c="31" xlink:href="#MJX-3-TEX-N-31"></use></g></g></g></svg> 个网络</strong></p><p>类似的, <strong>B类地址一个网络最多有 <svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="6.816ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 3012.6 915.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-4-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-4-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-4-TEX-N-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path id="MJX-4-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-4-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-4-TEX-N-31"></use><use data-c="36" xlink:href="#MJX-4-TEX-N-36" transform="translate(500,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(1512.3,0)"><use data-c="2212" xlink:href="#MJX-4-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(2512.6,0)"><use data-c="32" xlink:href="#MJX-4-TEX-N-32"></use></g></g></g></svg> 个主机</strong></p><h4 id="C类地址"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#C%E7%B1%BB%E5%9C%B0%E5%9D%80" class="headerlink" title="C类地址"></a>C类地址</h4><p>与B类地址类似:</p><p><strong>C类地址有 <svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="6.816ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 3012.6 915.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-5-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-5-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-5-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-5-TEX-N-32"></use><use data-c="31" xlink:href="#MJX-5-TEX-N-31" transform="translate(500,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(1512.3,0)"><use data-c="2212" xlink:href="#MJX-5-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(2512.6,0)"><use data-c="31" xlink:href="#MJX-5-TEX-N-31"></use></g></g></g></svg> 个网络, 最多<svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="6.016ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 2659 915.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-6-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-6-TEX-N-38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z"></path><path id="MJX-6-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-6-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-6-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="38" xlink:href="#MJX-6-TEX-N-38"></use></g></g></g><g data-mml-node="mo" transform="translate(1158.8,0)"><use data-c="2212" xlink:href="#MJX-6-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(2159,0)"><use data-c="31" xlink:href="#MJX-6-TEX-N-31"></use></g></g></g></svg> 个主机</strong></p><h3 id="几类特殊的地址"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E5%87%A0%E7%B1%BB%E7%89%B9%E6%AE%8A%E7%9A%84%E5%9C%B0%E5%9D%80" class="headerlink" title="几类特殊的地址"></a>几类特殊的地址</h3><h4 id="网络地址"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80" class="headerlink" title="网络地址"></a>网络地址</h4><p>就是主机号全为0, 只能用来标识网络, 不能分配给主机</p><h4 id="直接广播地址"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E7%9B%B4%E6%8E%A5%E5%B9%BF%E6%92%AD%E5%9C%B0%E5%9D%80" class="headerlink" title="直接广播地址"></a>直接广播地址</h4><p>网络号+全1的主机号, 只能用来当目的地址, 在这个网络上的所有设备都将接受处理.</p><h4 id="受限广播地址"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E5%8F%97%E9%99%90%E5%B9%BF%E6%92%AD%E5%9C%B0%E5%9D%80" class="headerlink" title="受限广播地址"></a>受限广播地址</h4><p>就是255.255.255.255, 只能当目的地址.</p><p>这个网络的所有设备都要收.</p><p>不是整个英特网, 路由器会屏蔽这个包.</p><p>是一个<strong>E</strong>类地址</p><h4 id="这个网络中的这个主机"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E8%BF%99%E4%B8%AA%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E8%BF%99%E4%B8%AA%E4%B8%BB%E6%9C%BA" class="headerlink" title="这个网络中的这个主机"></a>这个网络中的这个主机</h4><p>就是0.0.0.0, 在主机第一次加入网络的时候问ip用.</p><p>是一个<strong>A</strong>类地址</p><h4 id="这个网络的特定主机"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E8%BF%99%E4%B8%AA%E7%BD%91%E7%BB%9C%E7%9A%84%E7%89%B9%E5%AE%9A%E4%B8%BB%E6%9C%BA" class="headerlink" title="这个网络的特定主机"></a>这个网络的特定主机</h4><p>就是网络号全0+主机号</p><p>是一个<strong>A</strong>类地址</p><h4 id="环回地址"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E7%8E%AF%E5%9B%9E%E5%9C%B0%E5%9D%80" class="headerlink" title="环回地址"></a>环回地址</h4><p>网络号是127, 主机号随意.</p><p>是一个<strong>A</strong>类地址</p><h2 id="NAT"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#NAT" class="headerlink" title="NAT"></a>NAT</h2><p>NAT可以解决ip地址不够用的问题.</p><p>其实就是一个NAT服务器后面罩着一群小东西, 小东西用一个端口发的数据包到了NAT服务器就变成了NAT的另一个端口发的.</p><p>然后NAT服务器会记录下来这个对应关系, 收到对应的数据包再按照NAT表发回去.</p><p>如果从外面收到NAT表里面没有的数据包, 那就把他给扔了.</p><h2 id="子网划分"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86" class="headerlink" title="子网划分"></a>子网划分</h2><h3 id="子网"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E5%AD%90%E7%BD%91" class="headerlink" title="子网"></a>子网</h3><p>网络号+主机号不合理, 借用主机号的几位区别子网.</p><p>划分子网纯属网络单位内部的事情, 在外面看他还是一个网络.</p><h3 id="子网掩码"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81" class="headerlink" title="子网掩码"></a>子网掩码</h3><p>子网掩码标识网络地址.</p><p>子网掩码与IP地址按位与结果就是他的网络地址, 只有子网掩码按位与之后相等的两个IP地址, 才在一个子网里.</p><h3 id="划分子网的方法"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91%E7%9A%84%E6%96%B9%E6%B3%95" class="headerlink" title="划分子网的方法"></a>划分子网的方法</h3><h4 id="直接按类"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E7%9B%B4%E6%8E%A5%E6%8C%89%E7%B1%BB" class="headerlink" title="直接按类"></a>直接按类</h4><p>ABC类+子网划分, 不太好吧</p><h4 id="CIDR"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#CIDR" class="headerlink" title="CIDR"></a>CIDR</h4><p>无分类编址.</p><p>就是没有ABC类之分, 一切都靠子网掩码.</p><p>IP地址化成两部分: <strong>网络前缀; 主机号</strong></p><p>用斜线记法: ip地址/掩码1的长度</p><p>就是前多少位是前缀, 掩码长度就多少</p><h5 id="路由聚合-超网"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E8%B7%AF%E7%94%B1%E8%81%9A%E5%90%88-%E8%B6%85%E7%BD%91" class="headerlink" title="路由聚合/超网"></a>路由聚合/超网</h5><p>就是几个前几位相同的地址块, 可以合在一起用一个CIDR地址块包含起来, 就是看最长公共前缀.</p><h2 id="IPv6地址"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#IPv6%E5%9C%B0%E5%9D%80" class="headerlink" title="IPv6地址"></a>IPv6地址</h2><p>128位, 16字节, 32个数, 8段.</p><h3 id="缩短"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E7%BC%A9%E7%9F%AD" class="headerlink" title="缩短"></a>缩短</h3><p>每段开头有连续的0, 可以省去, 但是一段至少有一位.</p><p>如果有连续的全0段, 可以用一个**::**表示.</p><p>但是一个地址里最多只能出现一个**::**</p><h1 id="Chapter-20-IP协议"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#Chapter-20-IP%E5%8D%8F%E8%AE%AE" class="headerlink" title="Chapter 20 IP协议"></a>Chapter 20 IP协议</h1><h2 id="IP数据包的格式"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#IP%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9A%84%E6%A0%BC%E5%BC%8F" class="headerlink" title="IP数据包的格式"></a>IP数据包的格式</h2><p><img src="https://honoka.tech/img/Chapter19-22.assets/image-20210621184004060.png.webp" class="lazyload" data-srcset="/img/Chapter19-22.assets/image-20210621184004060.png.webp" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20210621184004060"/></p><p>一个一个说</p><ol><li>版本: 4bits, 说明IP数据报用的IPv4还是v6</li><li>首部长度: 4bits, ipv4数据报首部最大60字节, 一般都是20字节, 这个0-15的数字*4就是字节数. <strong>单位是4字节</strong></li><li>服务类型: 8bits, 没人用过.</li><li>总长度: 就是包括头部的, 整个IP数据报的长度, 最长65535B(具体多长限制于MTU) <strong>单位是1字节</strong></li><li>标识: 是一个计数器, 用来产生数据包的标识</li><li>标志: 前两位是MF/DF, 第三位没人用, 分片用的.</li><li>片漂移: 分片用的 <strong>单位是8字节</strong></li><li>生存时间(TTL): 到一个路由器就-1, 为0就给他扔了, 防止他转圈.</li><li>协议: 标明这个数据报应该交给什么协议处理.</li><li>首部校验和: 用一个更简单的方式, <strong>只检查首部是否有错</strong>.</li><li>源地址</li><li>目的地址</li></ol><h2 id="分段"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E5%88%86%E6%AE%B5" class="headerlink" title="分段"></a>分段</h2><h3 id="MTU"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#MTU" class="headerlink" title="MTU"></a>MTU</h3><p>Maximum Transmission Unit, <strong>链路层</strong>的一个属性.</p><p>就是一个帧里面他能装的最大数据字节数, 不包括链路层的头.</p><p>也就是说一个IP数据报长度不能超过他的下层链路层的MTU.</p><p>以太网的MTU是1500</p><p>所以数据一大肯定是要分段的</p><h3 id="标志位MF"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E6%A0%87%E5%BF%97%E4%BD%8DMF" class="headerlink" title="标志位MF"></a>标志位MF</h3><p>More Frames: 指示后面是不是还有这一帧被分出来的续帧.</p><p>也就是一个长达14800B的数据被做成了ip数据报, 长度15020, MF=0;</p><p>但是中间遇到了以太网, 看门的路由器就会把他分成10段, 每段1480B, 加上头正好1500B.</p><p>这十个数据报里面, 前九个的MF都是1, 只有最后的MF=0;</p><h2 id="IPv6数据报格式"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#IPv6%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%A0%BC%E5%BC%8F" class="headerlink" title="IPv6数据报格式"></a>IPv6数据报格式</h2><p><img src="https://honoka.tech/img/Chapter19-22.assets/image-20210621191854631.png.webp" class="lazyload" data-srcset="/img/Chapter19-22.assets/image-20210621191854631.png.webp" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20210621191854631"/></p><p>好, 除了版本都不一样.</p><p><img src="https://honoka.tech/img/Chapter19-22.assets/image-20210621192721966.png.webp" class="lazyload" data-srcset="/img/Chapter19-22.assets/image-20210621192721966.png.webp" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20210621192721966"/></p><p>拓展首部是算在载荷里的.</p><ol><li><p>版本: 4bits, 就是v4或者v6</p></li><li><p>通信量类, 8bits, 是一种优先级. 优先级中有两类, 前8个优先级可以被拥塞控制, 后8个不能被拥塞控制.</p></li><li><p>流标号, 20bits, 好像有一些神奇的用途, 视频和语音的传输之类的.</p></li><li><p>有效载荷长度: 16bits, 拓展首部+数据的长度, 最长能表示64KB.</p></li><li><p>下一个首部, 8bits, 协议字段或者类似链表指向下一个可选字段</p></li><li><p>跳数限制, 8bits, 类似TTL</p></li><li><p>源地址, 128bits.</p></li><li><p>目的地址, 128bits.</p><p><img src="https://honoka.tech/img/Chapter19-22.assets/image-20210621193900812.png.webp" class="lazyload" data-srcset="/img/Chapter19-22.assets/image-20210621193900812.png.webp" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20210621193900812"/></p></li></ol><h2 id="IPv4和IPv6混合"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#IPv4%E5%92%8CIPv6%E6%B7%B7%E5%90%88" class="headerlink" title="IPv4和IPv6混合"></a>IPv4和IPv6混合</h2><p>三种技术:</p><ol><li><p>双协议栈</p></li><li><p>头部转换</p></li><li><p>隧道</p></li></ol><h1 id="Chapter-21-地址映射-差错报告-多播"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#Chapter-21-%E5%9C%B0%E5%9D%80%E6%98%A0%E5%B0%84-%E5%B7%AE%E9%94%99%E6%8A%A5%E5%91%8A-%E5%A4%9A%E6%92%AD" class="headerlink" title="Chapter 21 地址映射 差错报告 多播"></a>Chapter 21 地址映射 差错报告 多播</h1><h2 id="ARP"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#ARP" class="headerlink" title="ARP"></a>ARP</h2><h3 id="作用"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E4%BD%9C%E7%94%A8" class="headerlink" title="作用"></a>作用</h3><p>一个主机在给另一个主机发IP数据报, 他知道对面的IP, 做好了IP数据报. 问题是链路层需要知道他的MAC地址.</p><p>这就是ARP的作用, 用一个IP就能拿到对应的MAC地址.</p><h3 id="方法"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E6%96%B9%E6%B3%95" class="headerlink" title="方法"></a>方法</h3><p>就是这个主机先<strong>广播</strong>一个ARP数据报, 说明自己想要谁的MAC地址.</p><p>然后这个主机收到之后, 就会<strong>单播</strong>一个ARP数据报, 告诉他自己的MAC地址.</p><p>如果要发送给的主机和自己不在一个子网, 发送方就先找路由器的MAC地址.</p><h3 id="数据报格式"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%A0%BC%E5%BC%8F" class="headerlink" title="数据报格式"></a>数据报格式</h3><p><img src="https://honoka.tech/img/Chapter19-22.assets/6-1911061F551c3.gif.webp" class="lazyload" data-srcset="/img/Chapter19-22.assets/6-1911061F551c3.gif.webp" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="6-1911061F551c3"/></p><ol><li>硬件类型, 以太网都是1.</li><li>协议类型, IP协议都是0800H</li><li>硬件地址长度, MAC地址都是6</li><li>协议(地址)长度, IPv4都是4</li><li>操作类型, 请求是1, 回复是2</li></ol><p>请求的时候, 目标MAC地址全0</p><h3 id="封装"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E5%B0%81%E8%A3%85" class="headerlink" title="封装"></a>封装</h3><p>ARP是三层协议, 还是要经过链路层的封装.</p><p>封装的时候, 发送时目的MAC地址是广播地址, 全1.</p><h2 id="DHCP"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#DHCP" class="headerlink" title="DHCP"></a>DHCP</h2><p>好像不太考, 只要知道他分ip的就行了</p><h2 id="ICMP"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#ICMP" class="headerlink" title="ICMP"></a>ICMP</h2><p>ICMP报文有两种:</p><ol><li>差错报告报文</li><li>询问报文</li></ol><h3 id="差错报告报文"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E5%B7%AE%E9%94%99%E6%8A%A5%E5%91%8A%E6%8A%A5%E6%96%87" class="headerlink" title="差错报告报文"></a>差错报告报文</h3><ol><li>终点不可达: 路由器或者主机不能交付数据报.</li><li>源站抑制: 拥塞而丢弃数据报.</li><li>时间超过: TTL为0, 或者终点在规定时间内不能收到数据报的全部报片.</li><li>参数问题: 数据报首部有不正确的值. (现在一般不发了)</li><li>改变路由: 仅由路由器发送, 让主机知道下一次应该发给其他路由(更好的路由).</li></ol><h4 id="不应发送差错报告报文的情况"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E4%B8%8D%E5%BA%94%E5%8F%91%E9%80%81%E5%B7%AE%E9%94%99%E6%8A%A5%E5%91%8A%E6%8A%A5%E6%96%87%E7%9A%84%E6%83%85%E5%86%B5" class="headerlink" title="不应发送差错报告报文的情况"></a>不应发送差错报告报文的情况</h4><ol><li>对ICMP差错报文不应再发一次.</li><li>对不是第一个的分片数据报不发</li><li>对具有组播地址的数据报不发</li><li>特殊地址(127.0.0.0或者0.0.0.0)不发</li></ol><h3 id="询问报文"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E8%AF%A2%E9%97%AE%E6%8A%A5%E6%96%87" class="headerlink" title="询问报文"></a>询问报文</h3><p>我感觉这个分类不重要</p><h3 id="差错报文格式"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E5%B7%AE%E9%94%99%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F" class="headerlink" title="差错报文格式"></a>差错报文格式</h3><p>ICMP虽然是网络层协议, 但是ICMP报文还是要当成IP数据报的内容, 前面加个IP头送给链路层.</p><p>ICMP的差错报文包括了ICMP头, 还有出错了的数据报的IP头, 和那个IP数据报的数据的前8字节(包括了传输层的端口号)</p><p><strong>所以ICMP封装好的报文实际上有两个IP头, 一个是他应该有的IP头, 还有出错了的IP头</strong></p><p><img src="https://honoka.tech/img/Chapter19-22.assets/image-20210622091632516.png.webp" class="lazyload" data-srcset="/img/Chapter19-22.assets/image-20210622091632516.png.webp" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20210622091632516"/></p><h2 id="IGMP"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#IGMP" class="headerlink" title="IGMP"></a>IGMP</h2><p>好像不太重要.</p><p>控制网络中加入离开之类的东西.</p><p>跟ICMP一样, 装在IP数据报里发出去.</p><p>IGMP的IP数据报的TTL一定为1.</p><h1 id="Chapter-22-传递-转发和路由选择"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#Chapter-22-%E4%BC%A0%E9%80%92-%E8%BD%AC%E5%8F%91%E5%92%8C%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9" class="headerlink" title="Chapter 22 传递,转发和路由选择"></a>Chapter 22 传递,转发和路由选择</h1><h2 id="传递和转发和路由选择的区别"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E4%BC%A0%E9%80%92%E5%92%8C%E8%BD%AC%E5%8F%91%E5%92%8C%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E7%9A%84%E5%8C%BA%E5%88%AB" class="headerlink" title="传递和转发和路由选择的区别"></a>传递和转发和路由选择的区别</h2><p>传递是指知道了从哪发向哪之后, 把数据传过去的物理过程.</p><p>转发是指路由器根据<strong>转发表</strong>在决定从哪发向哪的过程.</p><p>路由选择是根据路由选择算法得到<strong>路由表</strong>的过程, <strong>转发表是从路由表得到的</strong>.</p><p>在讨论路由选择的原理的时候, 不区分路由表和转发表, 都叫路由表.</p><p>路由表只给出下一跳的地址, 这样可以让路由表更灵活.</p><h2 id="路由协议"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE" class="headerlink" title="路由协议"></a>路由协议</h2><p>自治系统: 就是比一个局域网更大的一个单位, 可以是一个机构的全部网络这样的, 这里面使用相同的路由选择协议.</p><p>路由协议分为两类:</p><ol><li>内部网关协议, 在一个自治系统内使用的协议<ol><li>RIP</li><li>OSPF</li></ol></li><li>外部网关协议, 组织不同的自治系统的协议<ol><li>BGP</li></ol></li></ol><h3 id="RIP"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#RIP" class="headerlink" title="RIP"></a>RIP</h3><p>使用<strong>距离-向量算法</strong>.</p><p>每个路由器每隔一段时间就把自己的路由表发给相邻的路由器.</p><p>一个路由器收到其他路由器的路由表后, 先把这个路由表的下一跳全部改成发给他路由表的这个路由器, 然后跳数全部+1.</p><p>然后把这个修改后的路由表跟自己的路由表比对, 发现改过的路由表有自己路由表没有的子网, 就把这一项加进去, 下一跳就走他.</p><p>发现他记录的哪一个地方自己的路由表也有, 看看自己本来是不是走他的. 如果本来就走他, 那无论如何都要更新一下, 变成他的距离+1.</p><p>如果自己本来不是走他的, 就看一下走他是不是会更近, 是的话更新一下.</p><p>每一段时间所有路由器都要跟最近的路由器沟通一下路由表, 如果有个路由器半天不说话, 旁边的路由器就知道他死了, 把距离改成16(不可达).</p><p>如果有个网死了, 旁边最近的一个路由器会在发自己的路由表的时候告诉旁边的人这个网死了, 其他路由器都会更新自己的路由表知道这个网死了.</p><p>但是可能会出现这样的情况, 就是有个网死了, 这个路由器刚想告诉别人这个网死了, 结果旁边有个傻逼嘴快发路由表告诉他自己可以到这个网, 只需要4步. 但是这个路由器可不知道这四步第一步就是从他那走. 然后这个路由器就听信这个傻逼把自己的路由表也给改了. 过了一会这个路由器告诉这个傻逼自己也能到这个网了, 只需要先到你那, 这样只需要5步. 这个傻逼一看自己本来就是走他那的, 他现在到那个网需要5步了, 是不是路变远了, 就把自己的路由表改成了6步到这个网. 这样捯饬半天, 等他们俩都把自己路由表折腾到16的时候, 两个傻逼才知道这个网死了. 所以不能把无限大设的太大, 要不然这俩傻逼搞半天都搞不懂这网死了. 这个叫, <strong>坏消息传得慢</strong>.</p><p>RIP属于<strong>应用层</strong>的协议, 他的报文通过<strong>UDP</strong>发出去.</p><h3 id="OSPF"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#OSPF" class="headerlink" title="OSPF"></a>OSPF</h3><p>这个方法比较强一点, 不是一种分布式算法.</p><p>每个路由器定时戳一戳身边的路由器看看他还活着没. 如果发现旁边有个人死了或者莫名其妙突然多了个人, 就赶紧发个通告告诉旁边的人自己身边人变了. 旁边的路由器收到这个通告的时候改一下自己的<strong>链路数据库</strong>, 并且把这个通过告诉给自己身边的其他人. 这样, 每个人的<strong>链路数据库</strong>都保持到了最新的拓扑情况. 这个链路数据库记录了整个网络长啥样. 然后每个路由器就能用Dijkstra记录出来到每个地方最近的路线了, 按照这个路线发给下一个人就行.</p><p>链路数据库保存了每个路由器的位置, 还有每条线路的速度延迟之类的数据, 不再像RIP只使用跳来衡量了.</p><p>OSPF的报文直接作为IP数据报的数据, 加个IP头就送给链路层了, 不用UDP, 可以看成传输层的协议.</p><p>但是一个自治系统太大了, 路由器可能存不下这么大的链路数据库, 更新链路数据可也很占带宽. 所以OSPF又把一个自治系统分成了一堆区域, 然后一个主干部分把所有区域连起来.</p><h3 id="BGP"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#BGP" class="headerlink" title="BGP"></a>BGP</h3><p>BGP属于外部网关协议, 是用于连接不同自治系统的协议.</p><p>每个自治系统需要找一个路由器当发言人, 然后每个自治系统之间的发言人刚开始会把自己的BGP路由表全部发出去, 之后只有当自己的自治系统网络结构发生变化之后才发.</p><p>BGP的报文使用<strong>TCP</strong>发出去, 所以BGP属于应用层协议.</p><p>BGP使用的是路径-向量协议.</p><h2 id="多-组-播"><a href="https://honoka.tech/2021/07/10/Chapter19-22/#%E5%A4%9A-%E7%BB%84-%E6%92%AD" class="headerlink" title="多(组)播"></a>多(组)播</h2><p>就是一个数据报用个组播地址, 到了一个路由器这个路由器就会把他复制几份发给不同的端口.</p><p><strong>组播地址使用D类地址</strong></p><p>组播地址需要换算成多播MAC地址, 但是D类地址中间有28位自由的, 但是换算成MAC地址只有23位与IP地址有关, 有5位信息丢失. 但是在一个网络中这样的冲突概率很小, 所以就不管了.</p></body></html>